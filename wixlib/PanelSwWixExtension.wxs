<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <!-- PanelSwCustomActions.dll binary -->
  <Fragment>
    <Binary Id="PanelSwCustomActions.dll" SuppressModularization="yes" SourceFile="$(var.PanelSwCustomActions.TargetPath)"></Binary>
  </Fragment>
  <!-- PswManagedCA.CA.dll binary -->
  <Fragment>
    <Binary Id="PswManagedCA.X64.dll" SuppressModularization="yes" SourceFile="$(var.TargetDir)..\..\..\obj\$(var.Configuration)\PswManagedCA\x64\PswManagedCA.CA.dll"></Binary>
    <Binary Id="PswManagedCA.X86.dll" SuppressModularization="yes" SourceFile="$(var.TargetDir)..\..\..\obj\$(var.Configuration)\PswManagedCA\x86\PswManagedCA.CA.dll"></Binary>
  </Fragment>
  <!-- DismX64.dll binary -->
  <Fragment>
    <Binary Id="DismX64.dll" SuppressModularization="yes" SourceFile="$(var.TargetDir)..\Dism\x64\Dism.dll"></Binary>
    <Binary Id="DismX86.dll" SuppressModularization="yes" SourceFile="$(var.TargetDir)..\Dism\Win32\Dism.dll"></Binary>
  </Fragment>

  <!-- ShellExecute -->
  <Fragment>
    <CustomAction Id="ShellExecute_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="PSW_ShellExecute" Execute="immediate" Return="check" />
    <CustomAction Id="ShellExecute_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Return="check" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ShellExecute_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ShellExecute_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="ShellExecute_Immediate" Before="ProcessComponents" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="ShellExecute_deferred">Executing commands</ProgressText>
      <ProgressText Action="ShellExecute_rollback">Executing commands</ProgressText>
      <ProgressText Action="ShellExecute_commit">Executing commands</ProgressText>
    </UI>
  </Fragment>

  <!-- CustomUninstallKey -->
  <Fragment>
    <CustomAction Id="CustomUninstallKey_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CustomUninstallKey_Immediate" Execute="immediate" Return="check" />
    <CustomAction Id="CustomUninstallKey_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CustomUninstallKey_deferred" Execute="deferred" Return="check" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="CustomUninstallKey_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CustomUninstallKey_deferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="CustomUninstallKey_Immediate" Before="PublishProduct" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <ProgressText Action="CustomUninstallKey_deferred">!(loc.CustomUninstallKey)</ProgressText>
      <ProgressText Action="CustomUninstallKey_rollback">!(loc.CustomUninstallKey)</ProgressText>
    </UI>
  </Fragment>

  <!-- RemoveRegistryValue -->
  <Fragment>
    <CustomAction Id="RemoveRegistryValue_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="RemoveRegistryValue_Immediate" Execute="immediate" Return="check" />
    <CustomAction Id="RemoveRegistryValue_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="RemoveRegistryValue_Deferred" Execute="deferred" Return="check" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="RemoveRegistryValue_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="RemoveRegistryValue_Deferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="RemoveRegistryValue_Immediate" After="RemoveRegistryValues" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <ProgressText Action="RemoveRegistryValue_deferred">!(loc.RemoveRegistryValue)</ProgressText>
      <ProgressText Action="RemoveRegistryValue_rollback">!(loc.RemoveRegistryValue)</ProgressText>
    </UI>
  </Fragment>

  <!-- ReadIniValues -->
  <Fragment>
    <CustomAction Id="ReadIniValues" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ReadIniValues" Execute="firstSequence" Return="check" />
    <InstallExecuteSequence>
      <Custom Action="ReadIniValues" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="ReadIniValues" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
  </Fragment>

  <!-- XmlSearch -->
  <Fragment>
    <CustomAction Id="XmlSearch" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="XmlSearch" Execute="firstSequence" Return="check" />
    <InstallExecuteSequence>
      <Custom Action="XmlSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="XmlSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
  </Fragment>

  <!-- Telemetry -->
  <Fragment>
    <CustomAction Id="Telemetry" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="Telemetry" Execute="immediate" Return="check" />
    <CustomAction Id="Telemetry_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="Telemetry_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="Telemetry_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="Telemetry" Before="ProcessComponents" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <ProgressText Action="Telemetry_deferred">!(loc.Telemetry)</ProgressText>
      <ProgressText Action="Telemetry_rollback">!(loc.Telemetry)</ProgressText>
      <ProgressText Action="Telemetry_commit">!(loc.Telemetry)</ProgressText>
    </UI>
  </Fragment>

  <!-- TerminateSuccessfully -->
  <Fragment>
    <CustomAction Id="TerminateSuccessfully_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="TerminateSuccessfully" Execute="immediate" Return="check" />
    <CustomAction Id="TerminateSuccessfully_Deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="TerminateSuccessfully" Execute="deferred" Return="check" HideTarget="yes" />
  </Fragment>

  <!-- SplitPath -->
  <Fragment>
    <CustomAction Id="SplitPath" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="SplitPath" Execute="immediate" Return="check" />

    <InstallExecuteSequence>
      <Custom Action="SplitPath" After="CostFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="SplitPath" After="CostFinalize" Overridable="yes"/>
    </InstallUISequence>
  </Fragment>

  <!-- PathExists -->
  <Fragment>
    <CustomAction Id="PathExists" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="SplitString" Execute="immediate" Return="check" />
  </Fragment>

  <!-- SplitString -->
  <Fragment>
    <CustomAction Id="SplitString" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="SplitString" Execute="immediate" Return="check" />
  </Fragment>

  <!-- TrimString -->
  <Fragment>
    <CustomAction Id="TrimString" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="TrimString" Execute="immediate" Return="check" />
  </Fragment>

  <!-- RegularExpression -->
  <Fragment>
    <CustomAction Id="RegularExpression" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="RegularExpression" Execute="firstSequence" Return="check" />
    <InstallUISequence>
      <Custom Action="RegularExpression" After="CostFinalize" Overridable="yes" />
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="RegularExpression" After="CostFinalize" Overridable="yes" />
    </InstallExecuteSequence>
  </Fragment>

  <!-- FileRegex -->
  <Fragment>
    <CustomAction Id="FileRegex_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="FileRegex" Execute="immediate" Return="check" />
    <CustomAction Id="FileRegex_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="FileRegex_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Return="check" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="FileRegex_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="FileRegex_Immediate" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="FileRegex_Immediate">!(loc.FileRegex)</ProgressText>
      <ProgressText Action="FileRegex_rollback">!(loc.FileRegex)</ProgressText>
      <ProgressText Action="FileRegex_deferred" Template="!(loc.FileRegexTemplate)">!(loc.FileRegex)</ProgressText>
      <ProgressText Action="FileRegex_commit">!(loc.FileRegex)</ProgressText>
    </UI>
  </Fragment>

  <!-- DeletePath -->
  <Fragment>
    <CustomAction Id="DeletePath" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="DeletePath" Execute="immediate" Return="check" />
    <CustomAction Id="DeletePath_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="DeletePath" Before="InstallFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="DeletePath_commit">Deleting files and folders</ProgressText>
    </UI>
  </Fragment>

  <Fragment>
    <Property Id="DOMAIN_ADMINISTRATORS" Value="N/A" />
    <Property Id="DOMAIN_GUESTS" Value="N/A" />
    <Property Id="DOMAIN_USERS" Value="N/A" />
    <Property Id="ENTERPRISE_DOMAIN_CONTROLLERS" Value="N/A" />
    <Property Id="DOMAIN_DOMAIN_CONTROLLERS" Value="N/A" />
    <Property Id="DOMAIN_COMPUTERS" Value="N/A" />
    <Property Id="BUILTIN_ADMINISTRATORS" Value="N/A" />
    <Property Id="BUILTIN_GUESTS" Value="N/A" />
    <Property Id="BUILTIN_USERS" Value="N/A" />
    <Property Id="LOCAL_ADMIN" Value="N/A" />
    <Property Id="LOCAL_GUEST" Value="N/A" />
    <Property Id="ACCOUNT_OPERATORS" Value="N/A" />
    <Property Id="BACKUP_OPERATORS" Value="N/A" />
    <Property Id="PRINTER_OPERATORS" Value="N/A" />
    <Property Id="SERVER_OPERATORS" Value="N/A" />
    <Property Id="AUTHENTICATED_USERS" Value="N/A" />
    <Property Id="PERSONAL_SELF" Value="N/A" />
    <Property Id="CREATOR_OWNER" Value="N/A" />
    <Property Id="CREATOR_GROUP" Value="N/A" />
    <Property Id="LOCAL_SYSTEM" Value="N/A" />
    <Property Id="POWER_USERS" Value="N/A" />
    <Property Id="EVERYONE" Value="N/A" />
    <Property Id="REPLICATOR" Value="N/A" />
    <Property Id="INTERACTIVE" Value="N/A" />
    <Property Id="NETWORK" Value="N/A" />
    <Property Id="SERVICE" Value="N/A" />
    <Property Id="RESTRICTED_CODE" Value="N/A" />
    <Property Id="WRITE_RESTRICTED_CODE" Value="N/A" />
    <Property Id="ANONYMOUS" Value="N/A" />
    <Property Id="SCHEMA_ADMINISTRATORS" Value="N/A" />
    <Property Id="CERT_SERV_ADMINISTRATORS" Value="N/A" />
    <Property Id="RAS_SERVERS" Value="N/A" />
    <Property Id="ENTERPRISE_ADMINS" Value="N/A" />
    <Property Id="GROUP_POLICY_ADMINS" Value="N/A" />
    <Property Id="ALIAS_PREW2KCOMPACC" Value="N/A" />
    <Property Id="LOCAL_SERVICE" Value="N/A" />
    <Property Id="NETWORK_SERVICE" Value="N/A" />
    <Property Id="REMOTE_DESKTOP" Value="N/A" />
    <Property Id="NETWORK_CONFIGURATION_OPS" Value="N/A" />
    <Property Id="PERFMON_USERS" Value="N/A" />
    <Property Id="PERFLOG_USERS" Value="N/A" />
    <Property Id="IIS_USERS" Value="N/A" />
    <Property Id="CRYPTO_OPERATORS" Value="N/A" />
    <Property Id="OWNER_RIGHTS" Value="N/A" />
    <Property Id="EVENT_LOG_READERS" Value="N/A" />
    <Property Id="ENTERPRISE_RO_DCs" Value="N/A" />
    <Property Id="CERTSVC_DCOM_ACCESS" Value="N/A" />

    <CustomAction Id="AccountNames" BinaryKey="PanelSwCustomActions.dll" DllEntry="AccountNames" Execute="firstSequence" />
    <InstallUISequence>
      <Custom Action="AccountNames" Before="AppSearch" Overridable="yes" />
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="AccountNames" Before="AppSearch" Overridable="yes" />
    </InstallExecuteSequence>
  </Fragment>

  <Fragment>
    <Property Id="UserDesktopFolder" Value="N/A"/>

    <CustomAction Id="FolderPaths" BinaryKey="PanelSwCustomActions.dll" DllEntry="FolderPaths" Execute="firstSequence" />
    <InstallUISequence>
      <Custom Action="FolderPaths" Before="AppSearch" Overridable="yes" />
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="FolderPaths" Before="AppSearch" Overridable="yes" />
    </InstallExecuteSequence>
  </Fragment>

  <!-- MsiSqlQuery -->
  <Fragment>
    <CustomAction Id="MsiSqlQuery" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="MsiSqlQuery" Execute="immediate" Return="check" />

    <InstallExecuteSequence>
      <Custom Action="MsiSqlQuery" After="CostFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
  </Fragment>

  <!-- Rollback -->
  <Fragment>
    <CustomAction Id="Rollback_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="Rollback" Execute="immediate" Return="check" />
    <CustomAction Id="Rollback_Deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="Rollback" Execute="deferred" Return="check" HideTarget="yes" />
  </Fragment>

  <!-- PromptCancel -->
  <Fragment>
    <CustomAction Id="PromptCancel_Immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="PromptCancel" Execute="immediate" Return="check" />
    <CustomAction Id="PromptCancel_Deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="PromptCancel" Execute="deferred" Return="check" HideTarget="yes" />
  </Fragment>

  <!-- TaskScheduler -->
  <Fragment>
    <CustomAction Id="TaskScheduler" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="TaskScheduler" Execute="immediate" Return="check" />
    <CustomAction Id="TaskScheduler_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="TaskScheduler_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="TaskScheduler_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="TaskScheduler" After="StartServices" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <ProgressText Action="TaskScheduler_deferred">!(loc.TaskScheduler)</ProgressText>
      <ProgressText Action="TaskScheduler_rollback">!(loc.TaskScheduler)</ProgressText>
    </UI>
  </Fragment>

  <!-- ExecOnComponent -->
  <Fragment>
    <CustomAction Id="ExecOnComponent" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ExecOnComponent" Execute="immediate" Return="check" />
    <CustomAction Id="ExecOnComponentRollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponentCommit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_BeforeStop_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_BeforeStop_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_AfterStop_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_AfterStop_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_BeforeStart_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_BeforeStart_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_AfterStart_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_AfterStart_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_BeforeStop_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_BeforeStop_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_AfterStop_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_AfterStop_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_BeforeStart_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_BeforeStart_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_AfterStart_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" HideTarget="yes" />
    <CustomAction Id="ExecOnComponent_Imp_AfterStart_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" HideTarget="yes" />
    <CustomActionRef Id="PSW_CheckRebootRequired"/>

    <InstallExecuteSequence>
      <Custom Action="ExecOnComponent" Before="ExecOnComponentRollback" Overridable="yes" />
      <Custom Action="ExecOnComponentRollback" Before="ProcessComponents" Overridable="yes"/>
      <Custom Action="ExecOnComponentCommit" Before="InstallFinalize" Overridable="yes"/>
      <Custom Action="ExecOnComponent_BeforeStop_rollback" Before="ExecOnComponent_BeforeStop_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_BeforeStop_deferred" Before="StopServices" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_BeforeStop_rollback" Before="ExecOnComponent_Imp_BeforeStop_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_BeforeStop_deferred" Before="StopServices" Overridable="yes"/>

      <Custom Action="ExecOnComponent_AfterStop_rollback" Before="ExecOnComponent_AfterStop_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_AfterStop_deferred" After="StopServices" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_AfterStop_rollback" Before="ExecOnComponent_Imp_AfterStop_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_AfterStop_deferred" After="StopServices" Overridable="yes"/>

      <Custom Action="ExecOnComponent_BeforeStart_rollback" Before="ExecOnComponent_BeforeStart_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_BeforeStart_deferred" Before="StartServices" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_BeforeStart_rollback" Before="ExecOnComponent_Imp_BeforeStart_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_BeforeStart_deferred" Before="StartServices" Overridable="yes"/>

      <Custom Action="ExecOnComponent_AfterStart_rollback" Before="ExecOnComponent_AfterStart_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_AfterStart_deferred" After="StartServices" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_AfterStart_rollback" Before="ExecOnComponent_Imp_AfterStart_deferred" Overridable="yes"/>
      <Custom Action="ExecOnComponent_Imp_AfterStart_deferred" After="StartServices" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <Error Id="27001">!(loc.ExecOnFailure)</Error>
      <Error Id="27006">!(loc.ExecOnConsoleFailure)</Error>
      <Error Id="27011">!(loc.ExecOnPromptAlways)</Error>
      <ProgressText Action="ExecOnComponent">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponentRollback">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponentCommit">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_BeforeStop_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_BeforeStop_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_BeforeStop_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_BeforeStop_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_AfterStop_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_AfterStop_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_AfterStop_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_AfterStop_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_BeforeStart_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_BeforeStart_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_BeforeStart_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_BeforeStart_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_AfterStart_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_AfterStart_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_AfterStart_rollback" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
      <ProgressText Action="ExecOnComponent_Imp_AfterStart_deferred" Template="!(loc.ExecOnComponentTemplate)">!(loc.ExecOnComponent)</ProgressText>
    </UI>
  </Fragment>

  <!-- DISM -->
  <Fragment>
    <CustomAction Id="DismSched" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="DismSched" Execute="immediate"/>
    <CustomAction Id="DismX86" SuppressModularization="yes" BinaryKey="DismX86.dll" DllEntry="Dism" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="DismX64" SuppressModularization="yes" BinaryKey="DismX64.dll" DllEntry="Dism" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomActionRef Id="PSW_CheckRebootRequired"/>

    <InstallExecuteSequence>
      <Custom Action="DismSched" Before="StopServices" Overridable="yes"><![CDATA[(VersionNT > 601)]]></Custom>
      <Custom Action="DismX86" After="DismSched" Overridable="yes"><![CDATA[DismX86 And (VersionNT > 601) And Not VersionNT64]]></Custom>
      <Custom Action="DismX64" After="DismSched" Overridable="yes"><![CDATA[DismX64 And (VersionNT64 > 601)]]></Custom>
    </InstallExecuteSequence>
    <UI>
      <Error Id="27003">!(loc.DismPackageFailure)</Error>
      <Error Id="27004">!(loc.DismFeatureFailure)</Error>
      <Error Id="27010">!(loc.DismUnwantedFeatureFailure)</Error>
      <ProgressText Action="DismSched">!(loc.Dism)</ProgressText>
      <ProgressText Action="DismX86" Template="!(loc.DismTemplate)">!(loc.Dism)</ProgressText>
      <ProgressText Action="DismX64" Template="!(loc.DismTemplate)">!(loc.Dism)</ProgressText>
    </UI>
  </Fragment>

  <!-- WebsiteConfigSched -->
  <Fragment>
    <CustomAction Id="PSW_WebsiteConfigSched" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="WebsiteConfigSched" Execute="immediate"/>
    <CustomAction Id="PSW_WebsiteConfigExec" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="WebsiteConfigExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>

    <InstallExecuteSequence>
      <Custom Action="PSW_WebsiteConfigSched" After="StartServices" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="PSW_WebsiteConfigSched">!(loc.PSW_WebsiteConfig)</ProgressText>
      <ProgressText Action="PSW_WebsiteConfigExec">!(loc.PSW_WebsiteConfig)</ProgressText>
      <Error Id="27007">!(loc.WebsiteConfigFailure)</Error>
    </UI>
  </Fragment>

  <!-- ZipFile -->
  <Fragment>
    <CustomAction Id="ZipFileSched" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ZipFileSched" Execute="immediate"/>
    <CustomAction Id="ZipFileExec" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="ZipFileSched" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="ZipFileSched">!(loc.ZipFile)</ProgressText>
      <ProgressText Action="ZipFileExec" Template="!(loc.ZipFileTemplate)">!(loc.ZipFile)</ProgressText>
    </UI>
  </Fragment>

  <!-- Unzip -->
  <Fragment>
    <CustomAction Id="UnzipSched" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="Unzip" Execute="immediate"/>
    <CustomAction Id="UnzipRollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="UnzipExec" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomActionRef Id="PSW_CheckRebootRequired"/>

    <InstallExecuteSequence>
      <Custom Action="UnzipSched" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="UnzipSched">!(loc.Unzip)</ProgressText>
      <ProgressText Action="UnzipExec" Template="!(loc.UnzipTemplate)">!(loc.Unzip)</ProgressText>
    </UI>
  </Fragment>

  <!-- ServiceConfig (account only for now) -->
  <Fragment>
    <CustomAction Id="PSW_ServiceConfig" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ServiceConfig" Execute="immediate"/>
    <CustomAction Id="PSW_ServiceConfigRlbk" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_ServiceConfigExec" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomActionRef Id="PSW_CheckRebootRequired"/>

    <InstallExecuteSequence>
      <Custom Action="PSW_ServiceConfig" After="InstallServices" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <Error Id="27002">!(loc.ServiceConfigFailure)</Error>
      <ProgressText Action="PSW_ServiceConfig">!(loc.ServiceConfig)</ProgressText>
      <ProgressText Action="PSW_ServiceConfigRlbk">!(loc.ServiceConfig)</ProgressText>
      <ProgressText Action="PSW_ServiceConfigExec">!(loc.ServiceConfig)</ProgressText>
    </UI>
  </Fragment>

  <!-- CleanPendingFileRenameOperations
         - Remove 'delete' entries from registry key HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations that schedule creation and deletion of the same file.
         - Remove 'delete' entries of files that are scheduled to install based on their component action
  -->
  <Fragment>
    <CustomAction Id="CleanPendingFileRenameOperationsSched" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CleanPendingFileRenameOperationsSched" Execute="immediate"/>
    <CustomAction Id="CleanPendingFileRenameOperations" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CleanPendingFileRenameOperations" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <InstallExecuteSequence>
      <Custom Action="CleanPendingFileRenameOperationsSched" Before="CleanPendingFileRenameOperations" Overridable="yes"/>
      <Custom Action="CleanPendingFileRenameOperations" Before="InstallFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
  </Fragment>

  <!-- InstallUtil -->
  <Fragment>
    <CustomAction Id="PSW_InstallUtilSched" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="InstallUtilSched" Execute="immediate"/>
    <CustomAction Id="PSW_InstallUtil_InstallExec_x86" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="InstallUtilExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_InstallRollback_x86" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="InstallUtilExec" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_UninstallExec_x86" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="InstallUtilExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_UninstallRollback_x86" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="InstallUtilExec" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_InstallExec_x64" SuppressModularization="yes" BinaryKey="PswManagedCA.X64.dll" DllEntry="InstallUtilExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_InstallRollback_x64" SuppressModularization="yes" BinaryKey="PswManagedCA.X64.dll" DllEntry="InstallUtilExec" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_UninstallExec_x64" SuppressModularization="yes" BinaryKey="PswManagedCA.X64.dll" DllEntry="InstallUtilExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <CustomAction Id="PSW_InstallUtil_UninstallRollback_x64" SuppressModularization="yes" BinaryKey="PswManagedCA.X64.dll" DllEntry="InstallUtilExec" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes"/>

    <InstallExecuteSequence>
      <Custom Action="PSW_InstallUtilSched" Before="ProcessComponents" Overridable="yes"/>

      <Custom Action="PSW_InstallUtil_InstallRollback_x64" Before="PSW_InstallUtil_InstallExec_x64" Overridable="yes"><![CDATA[VersionNT64]]></Custom>
      <Custom Action="PSW_InstallUtil_InstallExec_x64" Before="InstallServices" Overridable="yes"><![CDATA[VersionNT64]]></Custom>
      <Custom Action="PSW_InstallUtil_InstallRollback_x86" Before="PSW_InstallUtil_InstallExec_x86" Overridable="yes"/>
      <Custom Action="PSW_InstallUtil_InstallExec_x86" Before="InstallServices" Overridable="yes"/>

      <Custom Action="PSW_InstallUtil_UninstallRollback_x86" Before="PSW_InstallUtil_UninstallExec_x86" Overridable="yes"/>
      <Custom Action="PSW_InstallUtil_UninstallExec_x86" Before="DeleteServices" Overridable="yes"/>
      <Custom Action="PSW_InstallUtil_UninstallRollback_x64" Before="PSW_InstallUtil_UninstallExec_x64" Overridable="yes"><![CDATA[VersionNT64]]></Custom>
      <Custom Action="PSW_InstallUtil_UninstallExec_x64" Before="DeleteServices" Overridable="yes"><![CDATA[VersionNT64]]></Custom>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="PSW_InstallUtil_InstallExec_x86">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_InstallRollback_x86">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_UninstallExec_x86">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_UninstallRollback_x86">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_InstallExec_x64">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_InstallRollback_x64">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_UninstallExec_x64">!(loc.InstallUtil)</ProgressText>
      <ProgressText Action="PSW_InstallUtil_UninstallRollback_x64">!(loc.InstallUtil)</ProgressText>
    </UI>
  </Fragment>

  <!-- SqlSearch -->
  <Fragment>
    <CustomAction Id="SqlSearch" BinaryKey="PanelSwCustomActions.dll" DllEntry="SqlSearch" Execute="firstSequence" />
    <InstallExecuteSequence>
      <Custom Action="SqlSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="SqlSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <Error Id="27008">!(loc.PSW_SqlSearchFailure)</Error>
      <ProgressText Action="SqlSearch">!(loc.SqlSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- XslTransform -->
  <Fragment>
    <CustomAction Id="PSW_XslTransform" BinaryKey="PanelSwCustomActions.dll" DllEntry="XslTransform" Execute="immediate" />
    <CustomAction Id="PSW_XslTransformExec" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <InstallExecuteSequence>
      <Custom Action="PSW_XslTransform" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="PSW_XslTransform">!(loc.PSW_XslTransform)</ProgressText>
      <ProgressText Action="PSW_XslTransformExec">!(loc.PSW_XslTransform)</ProgressText>
    </UI>
  </Fragment>

  <!-- SqlScript -->
  <Fragment>
    <CustomAction Id="PSW_SqlScript" BinaryKey="PanelSwCustomActions.dll" DllEntry="SqlScript" Execute="immediate" />
    <CustomAction Id="PSW_SqlScriptRollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="yes" HideTarget="yes"/>
    <CustomAction Id="PSW_SqlScriptExec" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="yes" HideTarget="yes"/>
    <InstallExecuteSequence>
      <Custom Action="PSW_SqlScript" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <Error Id="27005">!(loc.PSW_SqlScriptFailure)</Error>
      <ProgressText Action="PSW_SqlScript">!(loc.PSW_SqlScript)</ProgressText>
      <ProgressText Action="PSW_SqlScriptRollback" Template="!(loc.PSW_SqlScriptTemplate)">!(loc.PSW_SqlScript)</ProgressText>
      <ProgressText Action="PSW_SqlScriptExec" Template="!(loc.PSW_SqlScriptTemplate)">!(loc.PSW_SqlScript)</ProgressText>
    </UI>
  </Fragment>

  <!-- BackupAndRestore -->
  <Fragment>
    <CustomAction Id="BackupAndRestore" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="BackupAndRestore" Execute="immediate" Return="check" />
    <CustomAction Id="BackupAndRestore_rollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="BackupAndRestore_deferred" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="BackupAndRestore_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="BackupAndRestore" Before="RemoveExistingProducts" Overridable="yes"/>
      <Custom Action="BackupAndRestore_rollback" Before="ProcessComponents" Overridable="yes"/>
      <Custom Action="BackupAndRestore_commit" Before="InstallFinalize" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <ProgressText Action="BackupAndRestore">!(loc.BackupAndRestore)</ProgressText>
      <ProgressText Action="BackupAndRestore_rollback">!(loc.BackupAndRestore)</ProgressText>
      <ProgressText Action="BackupAndRestore_deferred">!(loc.BackupAndRestore)</ProgressText>
      <ProgressText Action="BackupAndRestore_commit">!(loc.BackupAndRestore)</ProgressText>
    </UI>
  </Fragment>

  <Fragment>
    <Property Id="BackupAndRestore_deferred_After_DuplicateFiles" Hidden="yes"/>
    <InstallExecuteSequence>
      <Custom Action="BackupAndRestore_deferred" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
  </Fragment>

  <Fragment>
    <Property Id="BackupAndRestore_deferred_Before_InstallFiles" Hidden="yes"/>
    <InstallExecuteSequence>
      <Custom Action="BackupAndRestore_deferred" Before="InstallFiles" Overridable="yes"/>
    </InstallExecuteSequence>
  </Fragment>

  <Fragment>
    <Property Id="BackupAndRestore_deferred_After_RemoveExistingProducts" Hidden="yes"/>
    <InstallExecuteSequence>
      <Custom Action="BackupAndRestore_deferred" After="RemoveExistingProducts" Overridable="yes"/>
    </InstallExecuteSequence>
  </Fragment>

  <!-- TopShelf service -->
  <Fragment>
    <CustomAction Id="TopShelf" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="TopShelf" Execute="immediate" Return="check" />
    <CustomAction Id="TopShelfService_InstallRollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="TopShelfService_Install" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="TopShelfService_UninstallRollback" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" HideTarget="yes" />
    <CustomAction Id="TopShelfService_Uninstall" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" HideTarget="yes" />

    <InstallExecuteSequence>
      <Custom Action="TopShelf" Before="TopShelfService_UninstallRollback" Overridable="yes"/>
      <Custom Action="TopShelfService_InstallRollback" Before="TopShelfService_Install" Overridable="yes"/>
      <Custom Action="TopShelfService_Install" Before="InstallServices" Overridable="yes"/>
      <Custom Action="TopShelfService_UninstallRollback" Before="TopShelfService_Uninstall" Overridable="yes"/>
      <Custom Action="TopShelfService_Uninstall" Before="DeleteServices" Overridable="yes"/>
    </InstallExecuteSequence>

    <UI>
      <Error Id="27000">!(loc.TopShelfFailure)</Error>
      <ProgressText Action="TopShelf">!(loc.TopShelf)</ProgressText>
      <ProgressText Action="TopShelfService_InstallRollback">!(loc.TopShelf)</ProgressText>
      <ProgressText Action="TopShelfService_Install">!(loc.TopShelf)</ProgressText>
      <ProgressText Action="TopShelfService_UninstallRollback">!(loc.TopShelf)</ProgressText>
      <ProgressText Action="TopShelfService_Uninstall">!(loc.TopShelf)</ProgressText>
    </UI>
  </Fragment>

  <!-- CreateSelfSignCertificate -->
  <Fragment>
    <CustomAction Id="CreateSelfSignCertificate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CreateSelfSignCertificate" Execute="immediate" Return="check" />
    <CustomAction Id="CreateSelfSignCertificate_commit" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" />
    <InstallExecuteSequence>
      <Custom Action="CreateSelfSignCertificate" Before="InstallInitialize" Overridable="yes"/>
      <Custom Action="CreateSelfSignCertificate_commit" Before="InstallFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="CreateSelfSignCertificate">!(loc.CreateSelfSignCertificate)</ProgressText>
    </UI>
  </Fragment>

  <!-- ForceVersion -->
  <Fragment>
    <CustomAction Id="ForceVersion" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ForceVersion" Execute="firstSequence"/>
    <InstallExecuteSequence>
      <Custom Action="ForceVersion" Before="CostInitialize" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="ForceVersion" Before="CostInitialize" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="ForceVersion">!(loc.ForceVersion)</ProgressText>
    </UI>
  </Fragment>

  <!-- SetPropertyFromPipe -->
  <Fragment>
    <CustomAction Id="SetPropertyFromPipe" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="SetPropertyFromPipe" Execute="immediate"/>
    <InstallExecuteSequence>
      <Custom Action="SetPropertyFromPipe" Before="InstallInitialize" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="SetPropertyFromPipe">!(loc.SetPropertyFromPipe)</ProgressText>
    </UI>
  </Fragment>

  <!-- EvaluateExpression -->
  <Fragment>
    <CustomAction Id="EvaluateExpression" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="EvaluateExpression" Execute="immediate"/>
    <InstallExecuteSequence>
      <Custom Action="EvaluateExpression" Before="InstallInitialize" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="EvaluateExpression">!(loc.EvaluateExpression)</ProgressText>
    </UI>
  </Fragment>

  <!-- CertificateHashSearch -->
  <Fragment>
    <CustomAction Id="CertificateHashSearch" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="CertificateHashSearch" Execute="firstSequence"/>
    <InstallExecuteSequence>
      <Custom Action="CertificateHashSearch" Before="LaunchConditions" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="CertificateHashSearch" Before="LaunchConditions" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="CertificateHashSearch">!(loc.CertificateHashSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- DiskSpace -->
  <Fragment>
    <CustomAction Id="DiskSpace" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="DiskSpace" Execute="immediate"/>
    <InstallExecuteSequence>
      <Custom Action="DiskSpace" After="CostFinalize" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="DiskSpace">!(loc.DiskSpace)</ProgressText>
    </UI>
  </Fragment>

  <!-- JsonJpath -->
  <Fragment>
    <CustomAction Id="JsonJpathSched" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="JsonJpathSched" Execute="immediate"/>
    <CustomAction Id="JsonJpathExec" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="JsonJpathExec" Execute="deferred" Impersonate="no" HideTarget="yes"/>
    <InstallExecuteSequence>
      <Custom Action="JsonJpathSched" After="DuplicateFiles" Overridable="yes"/>
    </InstallExecuteSequence>
    <UI>
      <Error Id="27009">!(loc.JsonJpathFailure)</Error>
      <ProgressText Action="JsonJpathSched">!(loc.JsonJpath)</ProgressText>
      <ProgressText Action="JsonJpathExec" Template="!(loc.JsonJpathTemplate)">!(loc.JsonJpath)</ProgressText>
    </UI>
  </Fragment>

  <!-- JsonJpathSearch -->
  <Fragment>
    <CustomAction Id="JsonJpathSearch" SuppressModularization="yes" BinaryKey="PswManagedCA.X86.dll" DllEntry="JsonJpathSearch" Execute="firstSequence"/>
    <InstallExecuteSequence>
      <Custom Action="JsonJpathSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="JsonJpathSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="JsonJpathSearch">!(loc.JsonJpathSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- AccountSidSearch -->
  <Fragment>
    <CustomAction Id="AccountSidSearch" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="AccountSidSearch" Execute="firstSequence" Return="check" />
    <InstallExecuteSequence>
      <Custom Action="AccountSidSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="AccountSidSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="AccountSidSearch">!(loc.AccountSidSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- VersionCompare -->
  <Fragment>
    <CustomAction Id="PSW_VersionCompare" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="VersionCompare" Execute="firstSequence" Return="check" />
    <InstallExecuteSequence>
      <Custom Action="PSW_VersionCompare" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="PSW_VersionCompare" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="PSW_VersionCompare">!(loc.PSW_VersionCompare)</ProgressText>
    </UI>
  </Fragment>

  <!-- PathSearch -->
  <Fragment>
    <CustomAction Id="PSW_PathSearch" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="PathSearch" Execute="firstSequence" Return="check" />
    <InstallExecuteSequence>
      <Custom Action="PSW_PathSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="PSW_PathSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="PSW_PathSearch">!(loc.PSW_PathSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- ToLowerCase -->
  <Fragment>
    <CustomAction Id="PSW_ToLowerCase" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" DllEntry="ToLowerCase" Execute="firstSequence" Return="check" />
    <InstallUISequence>
      <Custom Action="PSW_ToLowerCase" After="AppSearch" Overridable="yes" />
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="PSW_ToLowerCase" After="AppSearch" Overridable="yes" />
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="PSW_ToLowerCase">!(loc.PSW_ToLowerCase)</ProgressText>
    </UI>
  </Fragment>

  <Fragment>
    <CustomAction Id="PSW_CheckRebootRequired" BinaryKey="PanelSwCustomActions.dll" DllEntry="CheckRebootRequired" Execute="immediate" Return="ignore" SuppressModularization="yes" />

    <InstallExecuteSequence>
      <Custom Action="PSW_CheckRebootRequired" After="InstallFinalize" Overridable="yes"><![CDATA[VersionNT > 400]]></Custom>
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="PSW_CheckRebootRequired">!(loc.PSW_CheckRebootRequired)</ProgressText>
    </UI>
  </Fragment>

  <!-- WmiSearch -->
  <Fragment>
    <CustomAction Id="WmiSearch" BinaryKey="PanelSwCustomActions.dll" DllEntry="WmiSearch" Execute="firstSequence" />
    <InstallExecuteSequence>
      <Custom Action="WmiSearch" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="WmiSearch" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="WmiSearch">!(loc.WmiSearch)</ProgressText>
    </UI>
  </Fragment>

  <!-- Md5Hash -->
  <Fragment>
    <CustomAction Id="Md5Hash" BinaryKey="PanelSwCustomActions.dll" DllEntry="Md5Hash" Execute="firstSequence" />
    <InstallExecuteSequence>
      <Custom Action="Md5Hash" After="AppSearch" Overridable="yes"/>
    </InstallExecuteSequence>
    <InstallUISequence>
      <Custom Action="Md5Hash" After="AppSearch" Overridable="yes"/>
    </InstallUISequence>
    <UI>
      <ProgressText Action="Md5Hash">!(loc.Md5Hash)</ProgressText>
    </UI>
  </Fragment>

  <!-- RestartLocalResources -->
  <Fragment>
    <CustomAction Id="RestartLocalResources" BinaryKey="PanelSwCustomActions.dll" DllEntry="RestartLocalResources" Execute="immediate" SuppressModularization="yes"/>
    <CustomAction Id="RestartLocalResourcesExec" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" Return="ignore" SuppressModularization="yes" HideTarget="yes" />
    <InstallExecuteSequence>
      <Custom Action="RestartLocalResources" Before="InstallValidate" Overridable="yes" />
      <Custom Action="RestartLocalResourcesExec" Before="RemoveFiles" Overridable="yes" />
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="RestartLocalResources">!(loc.RestartLocalResources)</ProgressText>
      <ProgressText Action="RestartLocalResourcesExec" Template="!(loc.RestartLocalResourcesTemplate)">!(loc.RestartLocalResources)</ProgressText>
    </UI>
  </Fragment>

  <!-- ConcatFiles -->
  <Fragment>
    <CustomAction Id="ConcatFiles" BinaryKey="PanelSwCustomActions.dll" DllEntry="ConcatFiles" Execute="immediate" SuppressModularization="yes"/>
    <CustomAction Id="ConcatFilesExec" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="deferred" Impersonate="no" SuppressModularization="yes" HideTarget="yes" />
    <InstallExecuteSequence>
      <Custom Action="ConcatFiles" After="InstallFiles" Overridable="yes" />
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="ConcatFiles">!(loc.ConcatFiles)</ProgressText>
      <ProgressText Action="ConcatFilesExec">!(loc.ConcatFiles)</ProgressText>
    </UI>
  </Fragment>

  <!-- ExtractPayload -->
  <Fragment>
    <CustomAction Id="ExtractPayload" BinaryKey="PanelSwCustomActions.dll" DllEntry="ExtractPayload" Execute="immediate" SuppressModularization="yes"/>
    <CustomAction Id="ExtractPayloadRollback" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="rollback" Return="ignore" Impersonate="no" SuppressModularization="yes" HideTarget="yes" />
    <CustomAction Id="ExtractPayloadCommit" BinaryKey="PanelSwCustomActions.dll" DllEntry="CommonDeferred" Execute="commit" Return="ignore" Impersonate="no" SuppressModularization="yes" HideTarget="yes" />
    <InstallExecuteSequence>
      <Custom Action="ExtractPayload" Before="ProcessComponents" Overridable="yes" />
      <Custom Action="ExtractPayloadCommit" Before="InstallFinalize" Overridable="yes" />
    </InstallExecuteSequence>
    <UI>
      <ProgressText Action="ExtractPayload">!(loc.ExtractPayload)</ProgressText>
      <ProgressText Action="ExtractPayloadRollback">!(loc.ExtractPayload)</ProgressText>
      <ProgressText Action="ExtractPayloadCommit">!(loc.ExtractPayload)</ProgressText>
    </UI>
  </Fragment>

  <!-- PromptFileDowngrades -->
  <Fragment>
    <CustomAction Id="PromptFileDowngrades" DllEntry="PromptFileDowngrades" Execute="immediate" SuppressModularization="yes" BinaryKey="PanelSwCustomActions.dll" />
    <InstallExecuteSequence>
      <Custom Action="PromptFileDowngrades" After="InstallValidate" Overridable="yes" />
    </InstallExecuteSequence>
    <UI>
      <Error Id="27012">!(loc.PromptFileDowngrades)</Error>
    </UI>
  </Fragment>
</Wix>
